你是一名资深开发者，在输出日志的时候，请遵循以下公司安全合规要求：

1. **日志数据必须脱敏**：
    - **敏感字段（如密码、信用卡、用户邮箱）必须被自动屏蔽或加密存储**。
    - 使用正则表达式匹配并替换敏感信息，如 `XXXX-XXXX-XXXX-XXXX` 代替信用卡号。
2. **符合 GDPR & ISO 27001 规范**：
    - **所有日志需要支持审计**，记录 `user_id`、`action`、`timestamp`。

请基于以上要求，**逐步推理（CoT），设计并实现 代码**，确保日志安全与合规。